<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataMut Analysis Report</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        .severity-badge {
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .finding-row:hover {
            background-color: var(--bs-light);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .finding-row.selected {
            background-color: var(--bs-primary-bg-subtle);
            border-left: 4px solid var(--bs-primary);
        }
        
        .code-snippet {
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            background-color: var(--bs-gray-100);
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            border-left: 3px solid var(--bs-primary);
            max-width: 300px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .code-snippet:hover {
            max-width: none;
            white-space: pre-wrap;
            overflow: visible;
        }
        
        .stats-card {
            transition: transform 0.2s, box-shadow 0.2s;
            border: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        
        .filter-section {
            background: linear-gradient(135deg, var(--bs-light) 0%, var(--bs-secondary-bg) 100%);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid var(--bs-border-color);
        }
        
        .table-container {
            max-height: 70vh;
            overflow-y: auto;
        }
        
        .severity-LOW { 
            background: linear-gradient(45deg, #6c757d, #8e9297);
            color: white;
        }
        .severity-MEDIUM { 
            background: linear-gradient(45deg, #ffc107, #ffcd3a);
            color: black;
        }
        .severity-HIGH { 
            background: linear-gradient(45deg, #fd7e14, #ff922b);
            color: white;
        }
        .severity-CRITICAL { 
            background: linear-gradient(45deg, #dc3545, #e55563);
            color: white;
        }
        
        .library-badge {
            background: linear-gradient(45deg, #0dcaf0, #3dd5f3);
            color: white;
            font-size: 0.7rem;
            padding: 0.2rem 0.4rem;
            border-radius: 0.5rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .mutation-type {
            font-style: italic;
            color: var(--bs-secondary);
            font-weight: 500;
        }
        
        .notes-popover {
            max-width: 400px;
        }
        
        .search-highlight {
            background-color: yellow;
            font-weight: bold;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 2rem;
        }
        
        .risk-score {
            font-size: 2rem;
            font-weight: bold;
        }
        
        .risk-low { color: #198754; }
        .risk-medium { color: #ffc107; }
        .risk-high { color: #fd7e14; }
        .risk-critical { color: #dc3545; }
        
        .timeline-container {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .timeline-item {
            border-left: 3px solid var(--bs-primary);
            padding-left: 1rem;
            margin-bottom: 1rem;
            position: relative;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 0;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--bs-primary);
        }
        
        .file-selector {
            background: white;
            border: 2px solid var(--bs-primary);
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .file-selector:focus {
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
            border-color: var(--bs-primary);
        }
        
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        [data-bs-theme="dark"] .code-snippet {
            background-color: var(--bs-dark);
            color: var(--bs-light);
        }
        
        .floating-stats {
            position: sticky;
            top: 20px;
            z-index: 100;
        }
        
        .pulse-animation {
            animation: heartbeat 2s infinite;
        }
        
        @keyframes heartbeat {
            0% { transform: scale(1); }
            14% { transform: scale(1.1); }
            28% { transform: scale(1); }
            42% { transform: scale(1.05); }
            70% { transform: scale(1); }
        }
        
        .filter-active {
            border: 2px solid #28a745 !important;
            background-color: rgba(40, 167, 69, 0.1) !important;
        }
        
        .filter-status {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            margin-left: 0.5rem;
            display: none;
        }
        
        .filter-status.active {
            display: inline-block;
        }
        
        .group-status {
            background: linear-gradient(45deg, #0d6efd, #6610f2);
            color: white;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            margin-left: 0.5rem;
        }
    </style>
</head>
<body>
    <!-- Theme Toggle Button -->
    <button class="btn btn-outline-primary theme-toggle" onclick="toggleTheme()" title="Toggle Dark Mode">
        <i class="bi bi-moon-stars" id="theme-icon"></i>
    </button>

    <div class="container-fluid py-4">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col">
                <h1 class="display-4 text-primary">
                    <i class="bi bi-shield-exclamation pulse-animation"></i>
                    DataMut Analysis Report
                </h1>
                <p class="lead text-muted">
                    Generated on 2025-06-09T11:36:29.002282 | 53 findings across 1 files
                </p>
            </div>
        </div>

        <!-- Severity Bar Chart -->
        <div class="row mb-4">
            <div class="col">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="bi bi-bar-chart"></i>
                            Severity Distribution
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="severityChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Summary Statistics -->
        <div class="row mb-4">
            <div class="col-md-2">
                <div class="card stats-card h-100">
                    <div class="card-body text-center">
                        <h2 class="card-title text-primary">53</h2>
                        <p class="card-text">Total Findings</p>
                        <i class="bi bi-exclamation-triangle text-primary fs-1"></i>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card stats-card h-100">
                    <div class="card-body text-center">
                        <h2 class="card-title text-info">1</h2>
                        <p class="card-text">Files Analyzed</p>
                        <i class="bi bi-files text-info fs-1"></i>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card stats-card h-100">
                    <div class="card-body">
                        <h6 class="card-title">By Severity</h6>
                        
                            
                            
                        
                            
                            
                        
                            
                            
                                <div class="d-flex justify-content-between align-items-center mb-1">
                                    <span class="badge severity-HIGH severity-badge">HIGH</span>
                                    <span class="fw-bold">36</span>
                                </div>
                            
                        
                            
                            
                                <div class="d-flex justify-content-between align-items-center mb-1">
                                    <span class="badge severity-CRITICAL severity-badge">CRITICAL</span>
                                    <span class="fw-bold">17</span>
                                </div>
                            
                        
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card stats-card h-100">
                    <div class="card-body">
                        <h6 class="card-title">By Library</h6>
                        
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <span class="library-badge">pandas</span>
                                <span class="fw-bold">40</span>
                            </div>
                        
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <span class="library-badge">hardcoded</span>
                                <span class="fw-bold">13</span>
                            </div>
                        
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Filters -->
        <div class="filter-section">
            <h5 class="mb-3">
                <i class="bi bi-funnel"></i>
                Smart Filters & Grouping
                <span class="filter-status" id="filterStatus">Filters Active</span>
                <span class="group-status" id="groupStatus" style="display: none;">Grouped</span>
            </h5>
            <div class="row">
                <div class="col-md-3">
                    <label for="fileSelector" class="form-label">
                        <i class="bi bi-file-code"></i>
                        Select File to Analyze
                    </label>
                    <select class="form-select file-selector" id="fileSelector">
                        <option value="">All Files</option>
                        
                            <option value="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py" data-findings="53">
                                test_pandas_comprehensive.py (53 findings)
                            </option>
                        
                    </select>
                </div>
                <div class="col-md-2">
                    <label for="severityFilter" class="form-label">Severity</label>
                    <select class="form-select" id="severityFilter">
                        <option value="">All Severities</option>
                        
                            <option value="LOW">LOW</option>
                        
                            <option value="MEDIUM">MEDIUM</option>
                        
                            <option value="HIGH">HIGH</option>
                        
                            <option value="CRITICAL">CRITICAL</option>
                        
                    </select>
                </div>
                <div class="col-md-2">
                    <label for="libraryFilter" class="form-label">Library</label>
                    <select class="form-select" id="libraryFilter">
                        <option value="">All Libraries</option>
                        
                            <option value="pandas">pandas</option>
                        
                            <option value="hardcoded">hardcoded</option>
                        
                    </select>
                </div>
                <div class="col-md-2">
                    <label for="mutationFilter" class="form-label">Mutation Type</label>
                    <select class="form-select" id="mutationFilter">
                        <option value="">All Types</option>
                        
                            <option value="row/col drop">row/col drop</option>
                        
                            <option value="null value removal">null value removal</option>
                        
                            <option value="row deduplication">row deduplication</option>
                        
                            <option value="null value imputation">null value imputation</option>
                        
                            <option value="data concatenation">data concatenation</option>
                        
                            <option value="data transformation">data transformation</option>
                        
                            <option value="method chaining with mutations">method chaining with mutations</option>
                        
                            <option value="magic number">magic number</option>
                        
                    </select>
                </div>
                <div class="col-md-1 d-flex align-items-end">
                    <button class="btn btn-outline-secondary w-100" onclick="clearFilters()">
                        <i class="bi bi-x-circle"></i>
                        Clear
                    </button>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-3">
                    <label for="groupBySelector" class="form-label">
                        <i class="bi bi-collection"></i>
                        Group By
                    </label>
                    <select class="form-select" id="groupBySelector">
                        <option value="none">No Grouping</option>
                        <option value="severity">Group by Severity</option>
                        <option value="library">Group by Library</option>
                        <option value="mutation">Group by Mutation Type</option>
                        <option value="file">Group by File</option>
                        <option value="severity-library">Group by Severity → Library</option>
                        <option value="library-severity">Group by Library → Severity</option>
                    </select>
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <div class="btn-group w-100">
                        <button class="btn btn-outline-primary" onclick="toggleView()">
                            <i class="bi bi-view-list" id="view-icon"></i>
                            <span id="view-text">Timeline</span>
                        </button>
                    </div>
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <button class="btn btn-outline-success w-100" onclick="exportGroupedData()">
                        <i class="bi bi-download"></i>
                        Export
                    </button>
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <button class="btn btn-outline-info w-100" onclick="expandAllGroups()">
                        <i class="bi bi-arrows-expand"></i>
                        Expand All
                    </button>
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <button class="btn btn-outline-warning w-100" onclick="collapseAllGroups()">
                        <i class="bi bi-arrows-collapse"></i>
                        Collapse All
                    </button>
                </div>
            </div>
        </div>

        <!-- Timeline View (Hidden by default) -->
        <div class="card mb-4" id="timelineView" style="display: none;">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="bi bi-clock-history"></i>
                    Findings Timeline
                </h5>
            </div>
            <div class="card-body">
                <div class="timeline-container" id="timelineContainer">
                    <!-- Timeline items will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Findings Table -->
        <div class="card" id="tableView">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">
                    <i class="bi bi-table"></i>
                    Findings Details
                </h5>
                <div class="btn-group">
                    <button class="btn btn-sm btn-outline-success" onclick="selectAll()">
                        <i class="bi bi-check-all"></i>
                        Select All
                    </button>
                </div>
            </div>
            <div class="card-body p-0">
                <div class="table-container">
                    <table class="table table-hover mb-0" id="findingsTable">
                        <thead class="table-dark sticky-top">
                            <tr>
                                <th width="5%">
                                    <input type="checkbox" class="form-check-input" id="selectAllCheckbox" onchange="toggleSelectAll()">
                                </th>
                                <th width="20%">File</th>
                                <th width="8%">Line</th>
                                <th width="10%">Library</th>
                                <th width="15%">Function</th>
                                <th width="15%">Mutation Type</th>
                                <th width="10%">Severity</th>
                                <th width="25%">Code Snippet</th>
                                <th width="7%">Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">12</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop('A', axis=1)  # HIGH severity</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">13</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop('B', axis=1, inplace=True)  # CRITICAL severity (inplace=True)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="null value removal"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">14</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">dropna</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">null value removal</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.dropna()  # MEDIUM severity</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Removes rows/columns with missing values. May significantly reduce dataset size.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="null value removal"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">15</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">dropna</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">null value removal</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.dropna(inplace=True)  # HIGH severity (inplace=True)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Removes rows/columns with missing values. May significantly reduce dataset size.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row deduplication"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">16</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop_duplicates</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row deduplication</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop_duplicates()  # LOW severity</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Removes duplicate rows which may be legitimate data in some contexts.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row deduplication"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">17</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop_duplicates</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row deduplication</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop_duplicates(inplace=True)  # MEDIUM severity (inplace=True)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Removes duplicate rows which may be legitimate data in some contexts.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">20</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>result = df.drop('A', axis=1).dropna().drop_duplicates()</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">21</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop('B', axis=1).fillna(0).drop_duplicates(inplace=True)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">24</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>processed_df = (df
                .drop(['A', 'B'], axis=1)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">32</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop(columns_to_drop, axis=1)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">33</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop(df.columns[0], axis=1)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">34</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop(df.columns[:2], axis=1)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">38</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop('A', axis=1, inplace=True)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="null value removal"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">39</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">dropna</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">null value removal</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.dropna(inplace=True)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Removes rows/columns with missing values. May significantly reduce dataset size.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">43</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop(col, axis=1, inplace=True)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">68</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop(index=[0, 1])  # Drop by index</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">69</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop(columns=['A'])  # Drop by columns parameter</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="null value removal"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">70</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">dropna</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">null value removal</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.dropna(subset=['A', 'B'])  # Drop with subset</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Removes rows/columns with missing values. May significantly reduce dataset size.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="null value removal"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">71</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">dropna</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">null value removal</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.dropna(how='all')  # Drop with how parameter</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Removes rows/columns with missing values. May significantly reduce dataset size.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row deduplication"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">72</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop_duplicates</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row deduplication</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop_duplicates(subset=['A'])  # Drop duplicates with subset</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Removes duplicate rows which may be legitimate data in some contexts.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="null value imputation"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">73</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">fillna</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">null value imputation</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.fillna({'A': 0, 'B': 1})  # Fill with dictionary</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Replaces missing values with specified values. Can introduce bias if not done carefully.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="null value imputation"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">74</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">fillna</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">null value imputation</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.fillna(method='bfill', inplace=True)  # Fill with method and inplace</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Replaces missing values with specified values. Can introduce bias if not done carefully.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">77</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>result = df.drop('A', axis=1).dropna().reset_index(drop=True)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">81</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>new_df = df.drop('A', axis=1)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="null value removal"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">82</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">dropna</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">null value removal</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>modified_df = df.dropna().drop_duplicates()</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Removes rows/columns with missing values. May significantly reduce dataset size.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">85</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df2.drop('X', axis=1, inplace=True)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="data concatenation"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">86</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">concat</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">data concatenation</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>combined = pd.concat([df.drop('A', axis=1), df2.dropna()])</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Combines multiple DataFrames. Can introduce duplicate indices or misaligned data.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">86</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>combined = pd.concat([df.drop('A', axis=1), df2.dropna()])</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="null value removal"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">86</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">dropna</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">null value removal</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>combined = pd.concat([df.drop('A', axis=1), df2.dropna()])</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Removes rows/columns with missing values. May significantly reduce dataset size.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">90</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop([], axis=1)  # Empty list</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">91</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop('NonExistent', axis=1, errors='ignore')  # Non-existent column</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">97</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>filtered_df = df[mask].drop('B', axis=1).fillna(0)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="data transformation"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">100</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">apply</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">data transformation</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.apply(lambda x: x.drop('A', axis=1) if len(x) > 0 else x)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Applies function to data which can transform values in unpredictable ways depending on the function.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="method chaining with mutations"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">20</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop → dropna → drop_duplicates</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">method chaining with mutations</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>result = df.drop('A', axis=1).dropna().drop_duplicates()</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Chain of 3 mutation functions: drop → dropna → drop_duplicates. Mutation types: null value removal, row/col drop, row deduplication. Chained operations can compound data loss and make debugging difficult."
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="method chaining with mutations"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">21</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop → fillna → drop_duplicates</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">method chaining with mutations</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop('B', axis=1).fillna(0).drop_duplicates(inplace=True)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Chain of 3 mutation functions: drop → fillna → drop_duplicates. Mutation types: null value imputation, row/col drop, row deduplication. Chained operations can compound data loss and make debugging difficult."
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="method chaining with mutations"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">24</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop → dropna → drop_duplicates → fillna</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">method chaining with mutations</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>processed_df = (df
                .drop(['A', 'B'], axis=1)
                .dropna()
                .drop_duplicates()
                .fillna(method='ffill'))</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Chain of 4 mutation functions: drop → dropna → drop_duplicates → fillna. Mutation types: null value imputation, null value removal, row/col drop, row deduplication. Chained operations can compound data loss and make debugging difficult."
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="method chaining with mutations"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">47</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">dropna → drop_duplicates</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">method chaining with mutations</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>return data.drop('A', axis=1).dropna().drop_duplicates()</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Chain of 2 mutation functions: dropna → drop_duplicates. Mutation types: null value removal, row deduplication. Chained operations can compound data loss and make debugging difficult."
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="method chaining with mutations"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">77</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop → dropna → reset_index</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">method chaining with mutations</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>result = df.drop('A', axis=1).dropna().reset_index(drop=True)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Chain of 3 mutation functions: drop → dropna → reset_index. Mutation types: index modification, null value removal, row/col drop. Chained operations can compound data loss and make debugging difficult."
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="method chaining with mutations"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">82</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">dropna → drop_duplicates</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">method chaining with mutations</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>modified_df = df.dropna().drop_duplicates()</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Chain of 2 mutation functions: dropna → drop_duplicates. Mutation types: null value removal, row deduplication. Chained operations can compound data loss and make debugging difficult."
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="method chaining with mutations"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">97</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop → fillna</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">method chaining with mutations</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>filtered_df = df[mask].drop('B', axis=1).fillna(0)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Chain of 2 mutation functions: drop → fillna. Mutation types: null value imputation, row/col drop. Chained operations can compound data loss and make debugging difficult."
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="hardcoded" 
                                    data-mutation="magic number"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">8</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">hardcoded</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">magic_number</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">magic number</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6], 'C': [7, 8, 9]})</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Magic numbers pose CRITICAL risks in financial systems (amounts, rates, limits).
Use named constants and configuration management.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="hardcoded" 
                                    data-mutation="magic number"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">8</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">hardcoded</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">magic_number</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">magic number</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6], 'C': [7, 8, 9]})</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Magic numbers pose CRITICAL risks in financial systems (amounts, rates, limits).
Use named constants and configuration management.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="hardcoded" 
                                    data-mutation="magic number"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">8</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">hardcoded</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">magic_number</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">magic number</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6], 'C': [7, 8, 9]})</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Magic numbers pose CRITICAL risks in financial systems (amounts, rates, limits).
Use named constants and configuration management.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="hardcoded" 
                                    data-mutation="magic number"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">8</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">hardcoded</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">magic_number</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">magic number</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6], 'C': [7, 8, 9]})</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Magic numbers pose CRITICAL risks in financial systems (amounts, rates, limits).
Use named constants and configuration management.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="hardcoded" 
                                    data-mutation="magic number"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">8</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">hardcoded</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">magic_number</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">magic number</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6], 'C': [7, 8, 9]})</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Magic numbers pose CRITICAL risks in financial systems (amounts, rates, limits).
Use named constants and configuration management.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="hardcoded" 
                                    data-mutation="magic number"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">8</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">hardcoded</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">magic_number</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">magic number</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6], 'C': [7, 8, 9]})</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Magic numbers pose CRITICAL risks in financial systems (amounts, rates, limits).
Use named constants and configuration management.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="hardcoded" 
                                    data-mutation="magic number"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">8</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">hardcoded</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">magic_number</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">magic number</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6], 'C': [7, 8, 9]})</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Magic numbers pose CRITICAL risks in financial systems (amounts, rates, limits).
Use named constants and configuration management.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="hardcoded" 
                                    data-mutation="magic number"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">8</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">hardcoded</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">magic_number</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">magic number</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6], 'C': [7, 8, 9]})</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Magic numbers pose CRITICAL risks in financial systems (amounts, rates, limits).
Use named constants and configuration management.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="hardcoded" 
                                    data-mutation="magic number"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">9</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">hardcoded</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">magic_number</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">magic number</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df2 = pd.DataFrame({'X': [10, 20], 'Y': [30, 40]})</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Magic numbers pose CRITICAL risks in financial systems (amounts, rates, limits).
Use named constants and configuration management.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="hardcoded" 
                                    data-mutation="magic number"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">9</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">hardcoded</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">magic_number</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">magic number</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df2 = pd.DataFrame({'X': [10, 20], 'Y': [30, 40]})</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Magic numbers pose CRITICAL risks in financial systems (amounts, rates, limits).
Use named constants and configuration management.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="hardcoded" 
                                    data-mutation="magic number"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">9</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">hardcoded</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">magic_number</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">magic number</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df2 = pd.DataFrame({'X': [10, 20], 'Y': [30, 40]})</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Magic numbers pose CRITICAL risks in financial systems (amounts, rates, limits).
Use named constants and configuration management.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="hardcoded" 
                                    data-mutation="magic number"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">9</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">hardcoded</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">magic_number</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">magic number</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df2 = pd.DataFrame({'X': [10, 20], 'Y': [30, 40]})</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Magic numbers pose CRITICAL risks in financial systems (amounts, rates, limits).
Use named constants and configuration management.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="hardcoded" 
                                    data-mutation="magic number"
                                    data-file="/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/to-dolistbrokenno/testF/test_pandas_comprehensive.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">34</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">hardcoded</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">magic_number</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">magic number</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop(df.columns[:2], axis=1)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Magic numbers pose CRITICAL risks in financial systems (amounts, rates, limits).
Use named constants and configuration management.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Grouped Findings View (Hidden by default) -->
        <div class="card" id="groupedView" style="display: none;">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">
                    <i class="bi bi-collection"></i>
                    Grouped Findings
                </h5>
                <div class="btn-group">
                    <button class="btn btn-sm btn-outline-info" onclick="expandAllGroups()">
                        <i class="bi bi-arrows-expand"></i>
                        Expand All
                    </button>
                    <button class="btn btn-sm btn-outline-warning" onclick="collapseAllGroups()">
                        <i class="bi bi-arrows-collapse"></i>
                        Collapse All
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div id="groupedContainer">
                    <!-- Grouped content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Prism.js for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <script>
        let currentView = 'table';
        let selectedRows = new Set();
        let severityChart;
        
        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializePopovers();
            initializeSeverityChart();
            setupEventListeners();
        });
        
        // Initialize Bootstrap popovers
        function initializePopovers() {
            var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));
            var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
                return new bootstrap.Popover(popoverTriggerEl, {
                    container: 'body',
                    customClass: 'notes-popover'
                });
            });
        }
        
        // Initialize the severity bar chart
        function initializeSeverityChart() {
            const ctx = document.getElementById('severityChart').getContext('2d');
            const severityData = {
                'LOW': 0,
                'MEDIUM': 0,
                'HIGH': 36,
                'CRITICAL': 17
                };
            
            severityChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(severityData),
                    datasets: [{
                        label: 'Number of Findings',
                        data: Object.values(severityData),
                        backgroundColor: [
                            'rgba(108, 117, 125, 0.8)',
                            'rgba(255, 193, 7, 0.8)',
                            'rgba(253, 126, 20, 0.8)',
                            'rgba(220, 53, 69, 0.8)'
                        ],
                        borderColor: [
                            'rgba(108, 117, 125, 1)',
                            'rgba(255, 193, 7, 1)',
                            'rgba(253, 126, 20, 1)',
                            'rgba(220, 53, 69, 1)'
                        ],
                        borderWidth: 2,
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            borderColor: 'rgba(255,255,255,0.1)',
                            borderWidth: 1
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }
        
        // Setup event listeners
        function setupEventListeners() {
            const filters = ['fileSelector', 'severityFilter', 'libraryFilter', 'mutationFilter', 'groupBySelector'];
            filters.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', id === 'groupBySelector' ? handleGroupChange : filterTable);
                }
            });
        }
        
        // Enhanced filtering with file selection
        function filterTable() {
            const fileFilter = document.getElementById('fileSelector').value;
            const severityFilter = document.getElementById('severityFilter').value;
            const libraryFilter = document.getElementById('libraryFilter').value;
            const mutationFilter = document.getElementById('mutationFilter').value;
            
            const rows = document.querySelectorAll('#findingsTable tbody tr');
            let visibleCount = 0;
            
            rows.forEach(row => {
                const file = row.dataset.file;
                const severity = row.dataset.severity;
                const library = row.dataset.library;
                const mutation = row.dataset.mutation;
                
                const matchesFile = !fileFilter || file.includes(fileFilter);
                const matchesSeverity = !severityFilter || severity === severityFilter;
                const matchesLibrary = !libraryFilter || library === libraryFilter;
                const matchesMutation = !mutationFilter || mutation === mutationFilter;
                
                if (matchesFile && matchesSeverity && matchesLibrary && matchesMutation) {
                    row.style.display = '';
                    visibleCount++;
                } else {
                    row.style.display = 'none';
                }
            });
            
            // Update filter status indicator
            updateFilterStatus(fileFilter, severityFilter, libraryFilter, mutationFilter, visibleCount, rows.length);
            
            // Update visible count
            console.log(`Showing ${visibleCount} of ${rows.length} findings`);
            
            // If grouping is active, regenerate the grouped view with filtered data
            const groupBy = document.getElementById('groupBySelector').value;
            if (groupBy !== 'none') {
                generateGroupedView(groupBy);
            }
        }
        
        // Update filter status indicators
        function updateFilterStatus(fileFilter, severityFilter, libraryFilter, mutationFilter, visibleCount, totalCount) {
            const filterStatus = document.getElementById('filterStatus');
            const hasActiveFilters = fileFilter || severityFilter || libraryFilter || mutationFilter;
            
            if (hasActiveFilters) {
                const activeFilters = [];
                if (fileFilter) activeFilters.push(`File: ${fileFilter.split('/').pop()}`);
                if (severityFilter) activeFilters.push(`Severity: ${severityFilter}`);
                if (libraryFilter) activeFilters.push(`Library: ${libraryFilter}`);
                if (mutationFilter) activeFilters.push(`Type: ${mutationFilter}`);
                
                filterStatus.innerHTML = `Filtered (${visibleCount}/${totalCount}) - ${activeFilters.join(', ')}`;
                filterStatus.classList.add('active');
                
                // Add visual indication to filter section
                document.querySelector('.filter-section').classList.add('filter-active');
            } else {
                filterStatus.classList.remove('active');
                document.querySelector('.filter-section').classList.remove('filter-active');
            }
        }
        
        // Toggle between table and timeline view
        function toggleView() {
            const tableView = document.getElementById('tableView');
            const timelineView = document.getElementById('timelineView');
            const groupedView = document.getElementById('groupedView');
            const viewIcon = document.getElementById('view-icon');
            const viewText = document.getElementById('view-text');
            
            if (currentView === 'table') {
                tableView.style.display = 'none';
                groupedView.style.display = 'none';
                timelineView.style.display = 'block';
                viewIcon.className = 'bi bi-table';
                viewText.textContent = 'Table';
                currentView = 'timeline';
                generateTimeline();
            } else {
                timelineView.style.display = 'none';
                groupedView.style.display = 'none';
                tableView.style.display = 'block';
                viewIcon.className = 'bi bi-view-list';
                viewText.textContent = 'Timeline';
                currentView = 'table';
            }
        }
        
        // Generate timeline view
        function generateTimeline() {
            const container = document.getElementById('timelineContainer');
            const findings = Array.from(document.querySelectorAll('#findingsTable tbody tr')).filter(row => row.style.display !== 'none');
            
            container.innerHTML = '';
            
            findings.forEach((row, index) => {
                const severity = row.dataset.severity;
                const library = row.dataset.library;
                const file = row.dataset.file;
                const line = row.cells[2].textContent;
                const func = row.cells[4].textContent;
                
                const timelineItem = document.createElement('div');
                timelineItem.className = 'timeline-item';
                timelineItem.innerHTML = `
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h6 class="mb-1">${func} <span class="badge severity-${severity} severity-badge">${severity}</span></h6>
                            <p class="mb-1 text-muted">${file}:${line}</p>
                            <small class="library-badge">${library}</small>
                        </div>
                        <small class="text-muted">#${index + 1}</small>
                    </div>
                `;
                container.appendChild(timelineItem);
            });
        }
        
        // Row selection functionality
        function selectRow(row) {
            const checkbox = row.querySelector('.row-checkbox');
            checkbox.checked = !checkbox.checked;
            
            if (checkbox.checked) {
                row.classList.add('selected');
                selectedRows.add(row);
            } else {
                row.classList.remove('selected');
                selectedRows.delete(row);
            }
            
            updateSelectAllCheckbox();
        }
        
        // Toggle select all
        function toggleSelectAll() {
            const selectAllCheckbox = document.getElementById('selectAllCheckbox');
            const visibleRows = Array.from(document.querySelectorAll('#findingsTable tbody tr')).filter(row => row.style.display !== 'none');
            
            visibleRows.forEach(row => {
                const checkbox = row.querySelector('.row-checkbox');
                checkbox.checked = selectAllCheckbox.checked;
                
                if (selectAllCheckbox.checked) {
                    row.classList.add('selected');
                    selectedRows.add(row);
                } else {
                    row.classList.remove('selected');
                    selectedRows.delete(row);
                }
            });
        }
        
        // Update select all checkbox state
        function updateSelectAllCheckbox() {
            const selectAllCheckbox = document.getElementById('selectAllCheckbox');
            const visibleRows = Array.from(document.querySelectorAll('#findingsTable tbody tr')).filter(row => row.style.display !== 'none');
            const checkedRows = visibleRows.filter(row => row.querySelector('.row-checkbox').checked);
            
            selectAllCheckbox.indeterminate = checkedRows.length > 0 && checkedRows.length < visibleRows.length;
            selectAllCheckbox.checked = checkedRows.length === visibleRows.length && visibleRows.length > 0;
        }
        
        // Enhanced clear filters function
        function clearFilters() {
            document.getElementById('fileSelector').value = '';
            document.getElementById('severityFilter').value = '';
            document.getElementById('libraryFilter').value = '';
            document.getElementById('mutationFilter').value = '';
            document.getElementById('groupBySelector').value = 'none';
            
            // Reset to table view
            const tableView = document.getElementById('tableView');
            const groupedView = document.getElementById('groupedView');
            tableView.style.display = 'block';
            groupedView.style.display = 'none';
            
            // Reset status indicators
            document.getElementById('filterStatus').classList.remove('active');
            document.getElementById('groupStatus').style.display = 'none';
            document.querySelector('.filter-section').classList.remove('filter-active');
            
            filterTable();
        }
        
        // Dark mode toggle
        function toggleTheme() {
            const html = document.documentElement;
            const themeIcon = document.getElementById('theme-icon');
            
            if (html.getAttribute('data-bs-theme') === 'dark') {
                html.setAttribute('data-bs-theme', 'light');
                themeIcon.className = 'bi bi-moon-stars';
            } else {
                html.setAttribute('data-bs-theme', 'dark');
                themeIcon.className = 'bi bi-sun';
            }
        }
        
        // Select all visible rows
        function selectAll() {
            const selectAllCheckbox = document.getElementById('selectAllCheckbox');
            selectAllCheckbox.checked = true;
            toggleSelectAll();
        }

        // ============ GROUPING FUNCTIONALITY ============
        
        // Handle group change
        function handleGroupChange() {
            const groupBy = document.getElementById('groupBySelector').value;
            const tableView = document.getElementById('tableView');
            const groupedView = document.getElementById('groupedView');
            const groupStatus = document.getElementById('groupStatus');
            
            if (groupBy === 'none') {
                tableView.style.display = 'block';
                groupedView.style.display = 'none';
                groupStatus.style.display = 'none';
            } else {
                // First apply current filters to ensure we're working with filtered data
                filterTable();
                
                tableView.style.display = 'none';
                groupedView.style.display = 'block';
                generateGroupedView(groupBy);
                
                // Update the grouped view header to show filter status
                updateGroupedViewHeader(groupBy);
                
                // Show group status indicator
                const groupTypeText = groupBy.replace('-', ' → ').replace(/\b\w/g, l => l.toUpperCase());
                groupStatus.innerHTML = `Grouped by ${groupTypeText}`;
                groupStatus.style.display = 'inline-block';
            }
        }
        
        // Generate grouped view
        function generateGroupedView(groupBy) {
            const container = document.getElementById('groupedContainer');
            const rows = Array.from(document.querySelectorAll('#findingsTable tbody tr')).filter(row => row.style.display !== 'none');
            
            let groupedData = {};
            
            // Group the data
            rows.forEach(row => {
                let groupKey = getGroupKey(row, groupBy);
                if (!groupedData[groupKey]) {
                    groupedData[groupKey] = [];
                }
                groupedData[groupKey].push(row);
            });
            
            // Clear container
            container.innerHTML = '';
            
            // Sort groups by priority (CRITICAL > HIGH > MEDIUM > LOW for severity)
            const sortedGroups = Object.keys(groupedData).sort((a, b) => {
                if (groupBy.includes('severity')) {
                    const severityOrder = ['CRITICAL', 'HIGH', 'MEDIUM', 'LOW'];
                    const aIndex = severityOrder.findIndex(s => a.includes(s));
                    const bIndex = severityOrder.findIndex(s => b.includes(s));
                    if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;
                }
                return a.localeCompare(b);
            });
            
            // Create accordion for each group
            sortedGroups.forEach((groupKey, index) => {
                const groupData = groupedData[groupKey];
                const groupCard = createGroupCard(groupKey, groupData, index, groupBy);
                container.appendChild(groupCard);
            });
        }
        
        // Get group key based on grouping type
        function getGroupKey(row, groupBy) {
            const severity = row.dataset.severity;
            const library = row.dataset.library;
            const mutation = row.dataset.mutation;
            const file = row.dataset.file;
            
            switch (groupBy) {
                case 'severity':
                    return severity;
                case 'library':
                    return library;
                case 'mutation':
                    return mutation;
                case 'file':
                    return file.split('/').pop(); // Just filename
                case 'severity-library':
                    return `${severity} → ${library}`;
                case 'library-severity':
                    return `${library} → ${severity}`;
                default:
                    return 'Other';
            }
        }
        
        // Create group card
        function createGroupCard(groupKey, groupData, index, groupBy) {
            const card = document.createElement('div');
            card.className = 'card mb-3';
            
            const severityCounts = {};
            groupData.forEach(row => {
                const severity = row.dataset.severity;
                severityCounts[severity] = (severityCounts[severity] || 0) + 1;
            });
            
            const severityBadges = Object.entries(severityCounts)
                .map(([severity, count]) => `<span class="badge severity-${severity} severity-badge ms-1">${severity} (${count})</span>`)
                .join('');
            
            card.innerHTML = `
                <div class="card-header" id="heading${index}">
                    <h6 class="mb-0">
                        <button class="btn btn-link text-decoration-none w-100 text-start d-flex justify-content-between align-items-center" 
                                data-bs-toggle="collapse" 
                                data-bs-target="#collapse${index}" 
                                aria-expanded="true" 
                                aria-controls="collapse${index}">
                            <div>
                                <i class="bi bi-collection me-2"></i>
                                <strong>${groupKey}</strong>
                                <span class="text-muted ms-2">(${groupData.length} findings)</span>
                            </div>
                            <div>
                                ${severityBadges}
                                <i class="bi bi-chevron-down ms-2"></i>
                            </div>
                        </button>
                    </h6>
                </div>
                <div id="collapse${index}" class="collapse show" data-bs-parent="#groupedContainer">
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th width="25%">File</th>
                                        <th width="8%">Line</th>
                                        <th width="12%">Library</th>
                                        <th width="15%">Function</th>
                                        <th width="15%">Mutation Type</th>
                                        <th width="10%">Severity</th>
                                        <th width="15%">Code Snippet</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${generateGroupTableRows(groupData)}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
            
            return card;
        }
        
        // Generate table rows for a group
        function generateGroupTableRows(groupData) {
            return groupData.map(row => {
                const file = row.dataset.file.split('/').pop();
                const line = row.cells[2].textContent;
                const library = row.dataset.library;
                const func = row.cells[4].textContent;
                const mutation = row.dataset.mutation;
                const severity = row.dataset.severity;
                const codeSnippet = row.cells[7].textContent;
                
                return `
                    <tr class="finding-row">
                        <td>
                            <small class="text-muted">
                                <i class="bi bi-file-code text-primary me-1"></i>
                                ${file}
                            </small>
                        </td>
                        <td><span class="badge bg-light text-dark">${line}</span></td>
                        <td><span class="library-badge">${library}</span></td>
                        <td><code class="bg-transparent">${func}</code></td>
                        <td><span class="mutation-type">${mutation}</span></td>
                        <td><span class="badge severity-${severity} severity-badge">${severity}</span></td>
                        <td>
                            <div class="code-snippet" title="Click to expand">
                                <code>${codeSnippet}</code>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        // Expand all groups
        function expandAllGroups() {
            const collapses = document.querySelectorAll('#groupedContainer .collapse');
            collapses.forEach(collapse => {
                if (!collapse.classList.contains('show')) {
                    new bootstrap.Collapse(collapse, { show: true });
                }
            });
        }
        
        // Collapse all groups
        function collapseAllGroups() {
            const collapses = document.querySelectorAll('#groupedContainer .collapse');
            collapses.forEach(collapse => {
                if (collapse.classList.contains('show')) {
                    new bootstrap.Collapse(collapse, { hide: true });
                }
            });
        }
        
        // Export grouped data
        function exportGroupedData() {
            const groupBy = document.getElementById('groupBySelector').value;
            if (groupBy === 'none') {
                alert('Please select a grouping option before exporting.');
                return;
            }
            
            const rows = Array.from(document.querySelectorAll('#findingsTable tbody tr')).filter(row => row.style.display !== 'none');
            
            let csvContent = "Group,File,Line,Library,Function,Mutation Type,Severity,Code Snippet\n";
            
            let groupedData = {};
            rows.forEach(row => {
                let groupKey = getGroupKey(row, groupBy);
                if (!groupedData[groupKey]) {
                    groupedData[groupKey] = [];
                }
                groupedData[groupKey].push(row);
            });
            
            Object.entries(groupedData).forEach(([groupKey, groupData]) => {
                groupData.forEach(row => {
                    const file = row.dataset.file;
                    const line = row.cells[2].textContent;
                    const library = row.dataset.library;
                    const func = row.cells[4].textContent;
                    const mutation = row.dataset.mutation;
                    const severity = row.dataset.severity;
                    const codeSnippet = row.cells[7].textContent.replace(/"/g, '""');
                    
                    csvContent += `"${groupKey}","${file}","${line}","${library}","${func}","${mutation}","${severity}","${codeSnippet}"\n`;
                });
            });
            
            // Download CSV
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `datamut-grouped-by-${groupBy}-${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }
        
        // Update grouped view header to show filter status
        function updateGroupedViewHeader(groupBy) {
            const header = document.querySelector('#groupedView .card-header h5');
            const totalRows = document.querySelectorAll('#findingsTable tbody tr').length;
            const visibleRows = Array.from(document.querySelectorAll('#findingsTable tbody tr')).filter(row => row.style.display !== 'none').length;
            
            const filterInfo = visibleRows < totalRows ? 
                ` (${visibleRows}/${totalRows} findings after filtering)` : 
                ` (${visibleRows} findings)`;
            
            const groupTypeText = groupBy.replace('-', ' → ').replace(/\b\w/g, l => l.toUpperCase());
            
            header.innerHTML = `
                <i class="bi bi-collection"></i>
                Grouped by ${groupTypeText}${filterInfo}
            `;
        }
    </script>
</body>
</html> 