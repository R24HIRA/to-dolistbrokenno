<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataMut Analysis Report</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        .severity-badge {
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .finding-row:hover {
            background-color: var(--bs-light);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .finding-row.selected {
            background-color: var(--bs-primary-bg-subtle);
            border-left: 4px solid var(--bs-primary);
        }
        
        .code-snippet {
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            background-color: var(--bs-gray-100);
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            border-left: 3px solid var(--bs-primary);
            max-width: 300px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .code-snippet:hover {
            max-width: none;
            white-space: pre-wrap;
            overflow: visible;
        }
        
        .stats-card {
            transition: transform 0.2s, box-shadow 0.2s;
            border: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        
        .filter-section {
            background: linear-gradient(135deg, var(--bs-light) 0%, var(--bs-secondary-bg) 100%);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid var(--bs-border-color);
        }
        
        .table-container {
            max-height: 70vh;
            overflow-y: auto;
        }
        
        .severity-LOW { 
            background: linear-gradient(45deg, #6c757d, #8e9297);
            color: white;
        }
        .severity-MEDIUM { 
            background: linear-gradient(45deg, #ffc107, #ffcd3a);
            color: black;
        }
        .severity-HIGH { 
            background: linear-gradient(45deg, #fd7e14, #ff922b);
            color: white;
        }
        .severity-CRITICAL { 
            background: linear-gradient(45deg, #dc3545, #e55563);
            color: white;
        }
        
        .library-badge {
            background: linear-gradient(45deg, #0dcaf0, #3dd5f3);
            color: white;
            font-size: 0.7rem;
            padding: 0.2rem 0.4rem;
            border-radius: 0.5rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .mutation-type {
            font-style: italic;
            color: var(--bs-secondary);
            font-weight: 500;
        }
        
        .notes-popover {
            max-width: 400px;
        }
        
        .search-highlight {
            background-color: yellow;
            font-weight: bold;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 2rem;
        }
        
        .risk-score {
            font-size: 2rem;
            font-weight: bold;
        }
        
        .risk-low { color: #198754; }
        .risk-medium { color: #ffc107; }
        .risk-high { color: #fd7e14; }
        .risk-critical { color: #dc3545; }
        
        .timeline-container {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .timeline-item {
            border-left: 3px solid var(--bs-primary);
            padding-left: 1rem;
            margin-bottom: 1rem;
            position: relative;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 0;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--bs-primary);
        }
        
        .file-selector {
            background: white;
            border: 2px solid var(--bs-primary);
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .file-selector:focus {
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
            border-color: var(--bs-primary);
        }
        
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        [data-bs-theme="dark"] .code-snippet {
            background-color: var(--bs-dark);
            color: var(--bs-light);
        }
        
        .floating-stats {
            position: sticky;
            top: 20px;
            z-index: 100;
        }
        
        .pulse-animation {
            animation: heartbeat 2s infinite;
        }
        
        @keyframes heartbeat {
            0% { transform: scale(1); }
            14% { transform: scale(1.1); }
            28% { transform: scale(1); }
            42% { transform: scale(1.05); }
            70% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <!-- Theme Toggle Button -->
    <button class="btn btn-outline-primary theme-toggle" onclick="toggleTheme()" title="Toggle Dark Mode">
        <i class="bi bi-moon-stars" id="theme-icon"></i>
    </button>

    <div class="container-fluid py-4">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col">
                <h1 class="display-4 text-primary">
                    <i class="bi bi-shield-exclamation pulse-animation"></i>
                    DataMut Analysis Report
                </h1>
                <p class="lead text-muted">
                    Generated on 2025-06-03T14:43:46.443793 | 13 findings across 1 files
                </p>
            </div>
        </div>

        <!-- Severity Bar Chart -->
        <div class="row mb-4">
            <div class="col">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="bi bi-bar-chart"></i>
                            Severity Distribution
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="severityChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Summary Statistics -->
        <div class="row mb-4">
            <div class="col-md-2">
                <div class="card stats-card h-100">
                    <div class="card-body text-center">
                        <h2 class="card-title text-primary">13</h2>
                        <p class="card-text">Total Findings</p>
                        <i class="bi bi-exclamation-triangle text-primary fs-1"></i>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card stats-card h-100">
                    <div class="card-body text-center">
                        <h2 class="card-title text-info">1</h2>
                        <p class="card-text">Files Analyzed</p>
                        <i class="bi bi-files text-info fs-1"></i>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card stats-card h-100">
                    <div class="card-body">
                        <h6 class="card-title">By Severity</h6>
                        
                            
                            
                                <div class="d-flex justify-content-between align-items-center mb-1">
                                    <span class="badge severity-LOW severity-badge">LOW</span>
                                    <span class="fw-bold">1</span>
                                </div>
                            
                        
                            
                            
                                <div class="d-flex justify-content-between align-items-center mb-1">
                                    <span class="badge severity-MEDIUM severity-badge">MEDIUM</span>
                                    <span class="fw-bold">7</span>
                                </div>
                            
                        
                            
                            
                                <div class="d-flex justify-content-between align-items-center mb-1">
                                    <span class="badge severity-HIGH severity-badge">HIGH</span>
                                    <span class="fw-bold">3</span>
                                </div>
                            
                        
                            
                            
                                <div class="d-flex justify-content-between align-items-center mb-1">
                                    <span class="badge severity-CRITICAL severity-badge">CRITICAL</span>
                                    <span class="fw-bold">2</span>
                                </div>
                            
                        
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card stats-card h-100">
                    <div class="card-body">
                        <h6 class="card-title">By Library</h6>
                        
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <span class="library-badge">pandas</span>
                                <span class="fw-bold">7</span>
                            </div>
                        
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <span class="library-badge">numpy</span>
                                <span class="fw-bold">3</span>
                            </div>
                        
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <span class="library-badge">sql</span>
                                <span class="fw-bold">3</span>
                            </div>
                        
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Filters -->
        <div class="filter-section">
            <h5 class="mb-3">
                <i class="bi bi-funnel"></i>
                Smart Filters & File Selection
            </h5>
            <div class="row">
                <div class="col-md-4">
                    <label for="fileSelector" class="form-label">
                        <i class="bi bi-file-code"></i>
                        Select File to Analyze
                    </label>
                    <select class="form-select file-selector" id="fileSelector">
                        <option value="">All Files</option>
                        
                            <option value="/Users/r.hira/Projects/auditr/examples/data_analysis.py" data-findings="13">
                                data_analysis.py (13 findings)
                            </option>
                        
                    </select>
                </div>
                <div class="col-md-2">
                    <label for="severityFilter" class="form-label">Severity</label>
                    <select class="form-select" id="severityFilter">
                        <option value="">All Severities</option>
                        
                            <option value="LOW">LOW</option>
                        
                            <option value="MEDIUM">MEDIUM</option>
                        
                            <option value="HIGH">HIGH</option>
                        
                            <option value="CRITICAL">CRITICAL</option>
                        
                    </select>
                </div>
                <div class="col-md-2">
                    <label for="libraryFilter" class="form-label">Library</label>
                    <select class="form-select" id="libraryFilter">
                        <option value="">All Libraries</option>
                        
                            <option value="pandas">pandas</option>
                        
                            <option value="numpy">numpy</option>
                        
                            <option value="sql">sql</option>
                        
                    </select>
                </div>
                <div class="col-md-2">
                    <label for="mutationFilter" class="form-label">Mutation Type</label>
                    <select class="form-select" id="mutationFilter">
                        <option value="">All Types</option>
                        
                            <option value="row/col drop">row/col drop</option>
                        
                            <option value="row deduplication">row deduplication</option>
                        
                            <option value="null value removal">null value removal</option>
                        
                            <option value="null value imputation">null value imputation</option>
                        
                            <option value="row-set merge">row-set merge</option>
                        
                            <option value="data reshaping">data reshaping</option>
                        
                            <option value="element removal">element removal</option>
                        
                            <option value="shape modification">shape modification</option>
                        
                            <option value="element reordering">element reordering</option>
                        
                            <option value="data deletion">data deletion</option>
                        
                            <option value="data update">data update</option>
                        
                            <option value="data insertion">data insertion</option>
                        
                    </select>
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <div class="btn-group w-100">
                        <button class="btn btn-outline-secondary" onclick="clearFilters()">
                            <i class="bi bi-x-circle"></i>
                            Clear
                        </button>
                        <button class="btn btn-outline-primary" onclick="toggleView()">
                            <i class="bi bi-view-list" id="view-icon"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Timeline View (Hidden by default) -->
        <div class="card mb-4" id="timelineView" style="display: none;">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="bi bi-clock-history"></i>
                    Findings Timeline
                </h5>
            </div>
            <div class="card-body">
                <div class="timeline-container" id="timelineContainer">
                    <!-- Timeline items will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Findings Table -->
        <div class="card" id="tableView">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">
                    <i class="bi bi-table"></i>
                    Findings Details
                </h5>
                <div class="btn-group">
                    <button class="btn btn-sm btn-outline-success" onclick="selectAll()">
                        <i class="bi bi-check-all"></i>
                        Select All
                    </button>
                </div>
            </div>
            <div class="card-body p-0">
                <div class="table-container">
                    <table class="table table-hover mb-0" id="findingsTable">
                        <thead class="table-dark sticky-top">
                            <tr>
                                <th width="5%">
                                    <input type="checkbox" class="form-check-input" id="selectAllCheckbox" onchange="toggleSelectAll()">
                                </th>
                                <th width="20%">File</th>
                                <th width="8%">Line</th>
                                <th width="10%">Library</th>
                                <th width="15%">Function</th>
                                <th width="15%">Mutation Type</th>
                                <th width="10%">Severity</th>
                                <th width="25%">Code Snippet</th>
                                <th width="7%">Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/auditr/examples/data_analysis.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/auditr/examples/data_analysis.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">18</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df_cleaned = df.drop(columns=['unnecessary_col'])  # HIGH</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="MEDIUM" 
                                    data-library="pandas" 
                                    data-mutation="row deduplication"
                                    data-file="/Users/r.hira/Projects/auditr/examples/data_analysis.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/auditr/examples/data_analysis.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">19</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop_duplicates</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row deduplication</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-MEDIUM severity-badge">
                                            MEDIUM
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df_no_dupes = df.drop_duplicates()  # HIGH</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Removes duplicate rows which may be legitimate data in some contexts.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="MEDIUM" 
                                    data-library="pandas" 
                                    data-mutation="null value removal"
                                    data-file="/Users/r.hira/Projects/auditr/examples/data_analysis.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/auditr/examples/data_analysis.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">20</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">dropna</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">null value removal</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-MEDIUM severity-badge">
                                            MEDIUM
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df_no_na = df.dropna()  # HIGH</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Removes rows/columns with missing values. May significantly reduce dataset size.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="pandas" 
                                    data-mutation="row/col drop"
                                    data-file="/Users/r.hira/Projects/auditr/examples/data_analysis.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/auditr/examples/data_analysis.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">23</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">drop</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row/col drop</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.drop(columns=['temp_col'], inplace=True)  # CRITICAL</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Permanently removes data from DataFrame. Use with caution in production.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="MEDIUM" 
                                    data-library="pandas" 
                                    data-mutation="null value imputation"
                                    data-file="/Users/r.hira/Projects/auditr/examples/data_analysis.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/auditr/examples/data_analysis.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">24</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">fillna</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">null value imputation</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-MEDIUM severity-badge">
                                            MEDIUM
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df.fillna(0, inplace=True)  # CRITICAL</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Replaces missing values with specified values. Can introduce bias if not done carefully.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="MEDIUM" 
                                    data-library="pandas" 
                                    data-mutation="row-set merge"
                                    data-file="/Users/r.hira/Projects/auditr/examples/data_analysis.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/auditr/examples/data_analysis.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">27</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">merge</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">row-set merge</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-MEDIUM severity-badge">
                                            MEDIUM
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df_merged = pd.merge(df, df_cleaned, on='id')  # MEDIUM</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Can silently drop or duplicate rows depending on join type and key uniqueness.
Use validate parameter to catch unexpected behavior.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="MEDIUM" 
                                    data-library="pandas" 
                                    data-mutation="data reshaping"
                                    data-file="/Users/r.hira/Projects/auditr/examples/data_analysis.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/auditr/examples/data_analysis.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">28</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">pandas</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">pivot</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">data reshaping</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-MEDIUM severity-badge">
                                            MEDIUM
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>df_pivoted = df.pivot(index='date', columns='category', values='amount')  # MEDIUM</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Reshapes data from long to wide format. Can create sparse matrices with many NaN values.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="numpy" 
                                    data-mutation="element removal"
                                    data-file="/Users/r.hira/Projects/auditr/examples/data_analysis.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/auditr/examples/data_analysis.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">34</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">numpy</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">delete</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">element removal</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>arr_modified = np.delete(arr, 0)  # HIGH</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Removes elements from an array. Creates a new array with elements deleted.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="MEDIUM" 
                                    data-library="numpy" 
                                    data-mutation="shape modification"
                                    data-file="/Users/r.hira/Projects/auditr/examples/data_analysis.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/auditr/examples/data_analysis.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">35</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">numpy</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">reshape</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">shape modification</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-MEDIUM severity-badge">
                                            MEDIUM
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>arr_reshaped = np.reshape(arr, (5, 1))  # MEDIUM</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Changes the shape of an array without changing its data. Can affect data interpretation.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="LOW" 
                                    data-library="numpy" 
                                    data-mutation="element reordering"
                                    data-file="/Users/r.hira/Projects/auditr/examples/data_analysis.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/auditr/examples/data_analysis.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">36</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">numpy</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">sort</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">element reordering</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-LOW severity-badge">
                                            LOW
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>arr_sorted = np.sort(arr)  # LOW</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="Sorts an array. Changes element order but preserves all data.
"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="CRITICAL" 
                                    data-library="sql" 
                                    data-mutation="data deletion"
                                    data-file="/Users/r.hira/Projects/auditr/examples/data_analysis.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/auditr/examples/data_analysis.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">61</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">sql</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">DELETE</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">data deletion</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-CRITICAL severity-badge">
                                            CRITICAL
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>cursor.execute(delete_query)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="SQL DELETE operation detected in string literal"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="HIGH" 
                                    data-library="sql" 
                                    data-mutation="data update"
                                    data-file="/Users/r.hira/Projects/auditr/examples/data_analysis.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/auditr/examples/data_analysis.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">62</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">sql</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">UPDATE</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">data update</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-HIGH severity-badge">
                                            HIGH
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>cursor.execute(update_query)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="SQL UPDATE operation detected in string literal"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                                <tr class="finding-row" 
                                    data-severity="MEDIUM" 
                                    data-library="sql" 
                                    data-mutation="data insertion"
                                    data-file="/Users/r.hira/Projects/auditr/examples/data_analysis.py"
                                    onclick="selectRow(this)">
                                    <td>
                                        <input type="checkbox" class="form-check-input row-checkbox" onclick="event.stopPropagation()">
                                    </td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-code text-primary me-2"></i>
                                            <small class="text-muted">/Users/r.hira/Projects/auditr/examples/data_analysis.py</small>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">63</span>
                                    </td>
                                    <td>
                                        <span class="library-badge">sql</span>
                                    </td>
                                    <td>
                                        <code class="bg-transparent">INSERT</code>
                                    </td>
                                    <td>
                                        <span class="mutation-type">data insertion</span>
                                    </td>
                                    <td>
                                        <span class="badge severity-MEDIUM severity-badge">
                                            MEDIUM
                                        </span>
                                    </td>
                                    <td>
                                        <div class="code-snippet" title="Click to expand">
                                            <code>cursor.execute(insert_query)</code>
                                        </div>
                                    </td>
                                    <td>
                                        
                                            <button class="btn btn-sm btn-outline-info" 
                                                    data-bs-toggle="popover" 
                                                    data-bs-placement="left"
                                                    data-bs-content="SQL INSERT operation detected in string literal"
                                                    data-bs-html="true"
                                                    onclick="event.stopPropagation()">
                                                <i class="bi bi-info-circle"></i>
                                            </button>
                                        
                                    </td>
                                </tr>
                            
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Prism.js for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <script>
        let currentView = 'table';
        let selectedRows = new Set();
        let severityChart;
        
        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializePopovers();
            initializeSeverityChart();
            setupEventListeners();
        });
        
        // Initialize Bootstrap popovers
        function initializePopovers() {
            var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));
            var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
                return new bootstrap.Popover(popoverTriggerEl, {
                    container: 'body',
                    customClass: 'notes-popover'
                });
            });
        }
        
        // Initialize the severity bar chart
        function initializeSeverityChart() {
            const ctx = document.getElementById('severityChart').getContext('2d');
            const severityData = {
                'LOW': 1,
                'MEDIUM': 7,
                'HIGH': 3,
                'CRITICAL': 2
                };
            
            severityChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(severityData),
                    datasets: [{
                        label: 'Number of Findings',
                        data: Object.values(severityData),
                        backgroundColor: [
                            'rgba(108, 117, 125, 0.8)',
                            'rgba(255, 193, 7, 0.8)',
                            'rgba(253, 126, 20, 0.8)',
                            'rgba(220, 53, 69, 0.8)'
                        ],
                        borderColor: [
                            'rgba(108, 117, 125, 1)',
                            'rgba(255, 193, 7, 1)',
                            'rgba(253, 126, 20, 1)',
                            'rgba(220, 53, 69, 1)'
                        ],
                        borderWidth: 2,
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            borderColor: 'rgba(255,255,255,0.1)',
                            borderWidth: 1
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }
        
        // Setup event listeners
        function setupEventListeners() {
            const filters = ['fileSelector', 'severityFilter', 'libraryFilter', 'mutationFilter'];
            filters.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', filterTable);
                }
            });
        }
        
        // Enhanced filtering with file selection
        function filterTable() {
            const fileFilter = document.getElementById('fileSelector').value;
            const severityFilter = document.getElementById('severityFilter').value;
            const libraryFilter = document.getElementById('libraryFilter').value;
            const mutationFilter = document.getElementById('mutationFilter').value;
            
            const rows = document.querySelectorAll('#findingsTable tbody tr');
            let visibleCount = 0;
            
            rows.forEach(row => {
                const file = row.dataset.file;
                const severity = row.dataset.severity;
                const library = row.dataset.library;
                const mutation = row.dataset.mutation;
                
                const matchesFile = !fileFilter || file.includes(fileFilter);
                const matchesSeverity = !severityFilter || severity === severityFilter;
                const matchesLibrary = !libraryFilter || library === libraryFilter;
                const matchesMutation = !mutationFilter || mutation === mutationFilter;
                
                if (matchesFile && matchesSeverity && matchesLibrary && matchesMutation) {
                    row.style.display = '';
                    visibleCount++;
                } else {
                    row.style.display = 'none';
                }
            });
            
            // Update visible count
            console.log(`Showing ${visibleCount} of ${rows.length} findings`);
        }
        
        // Toggle between table and timeline view
        function toggleView() {
            const tableView = document.getElementById('tableView');
            const timelineView = document.getElementById('timelineView');
            const viewIcon = document.getElementById('view-icon');
            
            if (currentView === 'table') {
                tableView.style.display = 'none';
                timelineView.style.display = 'block';
                viewIcon.className = 'bi bi-table';
                currentView = 'timeline';
                generateTimeline();
            } else {
                tableView.style.display = 'block';
                timelineView.style.display = 'none';
                viewIcon.className = 'bi bi-view-list';
                currentView = 'table';
            }
        }
        
        // Generate timeline view
        function generateTimeline() {
            const container = document.getElementById('timelineContainer');
            const findings = Array.from(document.querySelectorAll('#findingsTable tbody tr')).filter(row => row.style.display !== 'none');
            
            container.innerHTML = '';
            
            findings.forEach((row, index) => {
                const severity = row.dataset.severity;
                const library = row.dataset.library;
                const file = row.dataset.file;
                const line = row.cells[2].textContent;
                const func = row.cells[4].textContent;
                
                const timelineItem = document.createElement('div');
                timelineItem.className = 'timeline-item';
                timelineItem.innerHTML = `
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h6 class="mb-1">${func} <span class="badge severity-${severity} severity-badge">${severity}</span></h6>
                            <p class="mb-1 text-muted">${file}:${line}</p>
                            <small class="library-badge">${library}</small>
                        </div>
                        <small class="text-muted">#${index + 1}</small>
                    </div>
                `;
                container.appendChild(timelineItem);
            });
        }
        
        // Row selection functionality
        function selectRow(row) {
            const checkbox = row.querySelector('.row-checkbox');
            checkbox.checked = !checkbox.checked;
            
            if (checkbox.checked) {
                row.classList.add('selected');
                selectedRows.add(row);
            } else {
                row.classList.remove('selected');
                selectedRows.delete(row);
            }
            
            updateSelectAllCheckbox();
        }
        
        // Toggle select all
        function toggleSelectAll() {
            const selectAllCheckbox = document.getElementById('selectAllCheckbox');
            const visibleRows = Array.from(document.querySelectorAll('#findingsTable tbody tr')).filter(row => row.style.display !== 'none');
            
            visibleRows.forEach(row => {
                const checkbox = row.querySelector('.row-checkbox');
                checkbox.checked = selectAllCheckbox.checked;
                
                if (selectAllCheckbox.checked) {
                    row.classList.add('selected');
                    selectedRows.add(row);
                } else {
                    row.classList.remove('selected');
                    selectedRows.delete(row);
                }
            });
        }
        
        // Update select all checkbox state
        function updateSelectAllCheckbox() {
            const selectAllCheckbox = document.getElementById('selectAllCheckbox');
            const visibleRows = Array.from(document.querySelectorAll('#findingsTable tbody tr')).filter(row => row.style.display !== 'none');
            const checkedRows = visibleRows.filter(row => row.querySelector('.row-checkbox').checked);
            
            selectAllCheckbox.indeterminate = checkedRows.length > 0 && checkedRows.length < visibleRows.length;
            selectAllCheckbox.checked = checkedRows.length === visibleRows.length && visibleRows.length > 0;
        }
        
        // Clear all filters
        function clearFilters() {
            document.getElementById('fileSelector').value = '';
            document.getElementById('severityFilter').value = '';
            document.getElementById('libraryFilter').value = '';
            document.getElementById('mutationFilter').value = '';
            filterTable();
        }
        
        // Dark mode toggle
        function toggleTheme() {
            const html = document.documentElement;
            const themeIcon = document.getElementById('theme-icon');
            
            if (html.getAttribute('data-bs-theme') === 'dark') {
                html.setAttribute('data-bs-theme', 'light');
                themeIcon.className = 'bi bi-moon-stars';
            } else {
                html.setAttribute('data-bs-theme', 'dark');
                themeIcon.className = 'bi bi-sun';
            }
        }
        
        // Select all visible rows
        function selectAll() {
            const selectAllCheckbox = document.getElementById('selectAllCheckbox');
            selectAllCheckbox.checked = true;
            toggleSelectAll();
        }
    </script>
</body>
</html> 